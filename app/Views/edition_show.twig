{% extends 'layout.twig' %}

{% set current_nav = 'editions' %}

{% block title %}{{ edition.edition_date }} — Daily Edition — The News Log{% endblock %}

{% block content %}
<section class="card card--edition">
    <header class="card__header">
        <div class="badge">Daily Edition • {{ edition.edition_date }}</div>
        <h2>{{ edition.title }}</h2>
        {% if edition.published_at %}
            <p class="edition-meta">Published {{ edition.published_at }}</p>
        {% endif %}
    </header>

    {% if links %}
        <ul class="list-links">
            {% for link in links %}
                <li class="list-links__item">
                    <div class="list-links__title-row">
                        <a class="link-title" href="{{ link.source_url ?? link.url }}" target="_blank" rel="noopener">{{ link.title }}</a>
                        <a class="link-source" href="{{ link.source_url ?? link.url }}" target="_blank" rel="noopener" aria-label="Read source for {{ link.title }}">↗</a>
                    </div>
                    {% if link.source_name %}
                        <span class="badge badge--muted">{{ link.source_name }}</span>
                    {% endif %}
                    {% if link.blurb %}
                        <p>{{ link.blurb }}</p>
                    {% endif %}
                    {% set linkTags = tagsByLink[link.id]|default([]) %}
                    {% if linkTags %}
                        <div class="tag-list">
                            {% for tag in linkTags %}
                                <a class="tag-pill" href="/tags/{{ tag.slug }}">#{{ tag.name }}</a>
                            {% endfor %}
                        </div>
                    {% endif %}
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <div class="empty-state">
            <p>No curated links for this edition.</p>
        </div>
    {% endif %}
</section>
{% endblock %}
