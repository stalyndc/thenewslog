{% extends 'layout.twig' %}

{% block title %}Inbox â€” The News Log{% endblock %}

{% block content %}
<section class="card">
    <div class="badge">Editor Inbox</div>
    <h2>New Items</h2>
    {% if message %}
        <div class="alert alert--success">{{ message }}</div>
    {% endif %}
    {% if error %}
        <div class="alert alert--error">{{ error }}</div>
    {% endif %}
    <div class="admin-toolbar">
        <form method="post" action="/admin/feeds/refresh" class="admin-toolbar__form">
            <button type="submit" class="btn btn-primary">Fetch Latest</button>
        </form>
        <a class="btn btn-secondary" href="/admin/feeds">Manage Feeds</a>
    </div>
    <form method="get" class="form-inline inbox-filter"
          action="/admin/inbox"
          hx-get="/admin/inbox/partial"
          hx-target="#inbox-list"
          hx-swap="innerHTML"
          hx-push-url="true">
        <label for="feed_id">Filter by Feed</label>
        <select id="feed_id" name="feed_id" class="input-control">
            <option value="">All feeds</option>
            {% for feed in feeds %}
                <option value="{{ feed.id }}" {% if selected_feed_id is not null and feed.id == selected_feed_id %}selected{% endif %}>{{ feed.title }}</option>
            {% endfor %}
        </select>
        <button type="submit" class="btn btn-primary">Apply</button>
    </form>
    <div id="inbox-list">
        {% include 'admin/partials/inbox_table.twig' %}
    </div>
</section>
{% endblock %}
